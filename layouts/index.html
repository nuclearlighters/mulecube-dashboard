{{ define "main" }}

<!-- Hero Section with Slideshow -->
<section class="hero">
    <div class="hero-slideshow">
        {{- range $i, $img := .Site.Params.heroImages }}
        <div class="hero-slide{{ if eq $i 0 }} active{{ end }}" style="background-image: url('/images/hero/{{ $img }}.jpg')"></div>
        {{- end }}
    </div>
    
    <div class="container">
        <div class="hero-content">
            <h1>The <span class="highlight">*internet,</span><br>in your backpack</h1>
            <p class="subtitle">
                When there's no signal, no power grid, no cell towers — MuleCube still works.
                Wikipedia. Maps. AI. Emergency messaging. All offline. All private.
            </p>
            <div class="hero-cta">
                <a href="#services" class="btn btn-primary">Browse Services</a>
                <a href="/docs/" class="btn btn-secondary">Documentation</a>
            </div>
        </div>
        
        <div class="hero-image">
            <img src="/images/product-base.png" alt="MuleCube Device">
        </div>
    </div>
</section>

<!-- Status Banner -->
<div class="status-banner" id="statusBanner">
    <span class="status-dot"></span>
    <span id="statusText">Checking services...</span>
</div>

<!-- Services Section -->
<main class="services-section container" id="services">
    <h2>Your Offline Services</h2>
    <p class="section-subtitle">Everything running on this device — no internet required</p>
    
    <!-- Search/Filter -->
    <div class="services-filter">
        <input type="text" 
               id="serviceSearch" 
               class="search-input" 
               placeholder="Search services..."
               autocomplete="off">
    </div>

    {{- $services := .Site.Params.services }}
<!-- Quick Start - Most Popular Services -->
    <div class="quick-start">
        <h3 class="category-title"><img src="/images/icons/ui-star.svg" alt="" class="category-icon"> Quick Start</h3>
        <p class="quick-start-subtitle">Most used services — start here</p>
        <div class="service-grid quick-grid">
            {{- $quickServices := slice 
                (index $services.knowledge.items 0)
                (index $services.knowledge.items 1)
                (index $services.ai.items 0)
                (index $services.ai.items 1)
                (index $services.files.items 0)
            }}
            {{- range $quickServices }}
            {{- $isDemo := hasPrefix site.BaseURL "https://demo." }}
            {{- $linkUrl := cond (and $isDemo .demo_url) .demo_url .url }}
            <a href="{{ $linkUrl }}" target="_blank" class="service-card quick-card" data-service="{{ .service }}">
                <div class="service-icon" style="background: linear-gradient(135deg, {{ .gradient }});">
                    {{- if .icon }}
                    <img src="{{ .icon }}" alt="" loading="lazy" onerror="this.style.display='none'; this.parentElement.innerHTML='{{ .fallback }}';">
                    {{- else }}
                    {{ .fallback }}
                    {{- end }}
                </div>
                <div class="service-info">
                    <h3>{{ .name }}</h3>
                    <p title="{{ .description }}">{{ .description }}</p>
                </div>
                <div class="service-status checking"></div>
            </a>
            {{- end }}
        </div>
    </div>    
    {{ partial "service-category.html" (dict "category" $services.ai "icon" "/images/icons/cat-ai.svg") }}
    {{ partial "service-category.html" (dict "category" $services.knowledge "icon" "/images/icons/cat-knowledge.svg") }}
    {{ partial "service-category.html" (dict "category" $services.collaboration "icon" "/images/icons/cat-collaboration.svg") }}
    {{ partial "service-category.html" (dict "category" $services.security "icon" "/images/icons/cat-security.svg") }}
    {{ partial "service-category.html" (dict "category" $services.files "icon" "/images/icons/cat-files.svg") }}
    {{ partial "service-category.html" (dict "category" $services.communication "icon" "/images/icons/cat-communication.svg") }}
    {{ partial "service-category.html" (dict "category" $services.tools "icon" "/images/icons/cat-tools.svg") }}

<!-- Advanced Section Toggle -->
    <div class="advanced-toggle">
        <button id="advancedToggle" class="toggle-btn">
            <img src="/images/icons/ui-chevron.svg" alt="" class="toggle-icon"> Show Admin Tools
        </button>
    </div>
    
    <div class="advanced-section" id="advancedSection" style="display: none;">
        {{ partial "service-category.html" (dict "category" $services.infrastructure "icon" "/images/icons/cat-infrastructure.svg") }}
        {{ partial "service-category.html" (dict "category" $services.admin "icon" "/images/icons/cat-admin.svg") }}
    </div>

</main>

{{ end }}
